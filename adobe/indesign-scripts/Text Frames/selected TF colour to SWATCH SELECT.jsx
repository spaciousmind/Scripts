if (parseFloat(app.version) < 6)doFunction();elseapp.doScript(doFunction, ScriptLanguage.JAVASCRIPT, undefined, UndoModes.ENTIRE_SCRIPT, "change text frame colours");function doFunction(){var doc = app.activeDocument;var sel = app.selection;swatchSelect()for (var i=0; i < sel.length; i++){app.selection[i].texts.everyItem().fillColor = app.activeDocument.swatches[mySwatchesResult].name;}function swatchSelect(){   with(myDialog = app.dialogs.add({name:"Swatches in the active document"})){      myDialogColumn = dialogColumns.add();      with(myDialogColumn){         with(borderPanels.add()){         staticTexts.add({staticLabel:"Swatches "});         mySwatches = app.activeDocument.swatches;            myDropdown = dropdowns.add();            myDropdown.stringList = mySwatches.everyItem().name;            myDropdown.selectedIndex = 0;         }      }      myReturn = myDialog.show();      if (myReturn == true){         mySwatchesResult = myDropdown.selectedIndex;         myDialog.destroy;         return mySwatchesResult;      } else {         myDialog.destroy();      }   }}}