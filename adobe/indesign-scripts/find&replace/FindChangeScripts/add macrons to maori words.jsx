//This script was auto generated by chainGREP.jsx//chainGREP.jsx is provided by Gregor Fellenz https://www.publishingx.de///Download at https://www.publishingx.de/download/chain-grepmain();function main() {	if (app.layoutWindows.length == 0) return;	var changeObject = app.documents[0];	if (changeObject.hasOwnProperty('characters') && changeObject.characters.length == 0) return;	var doc = app.documents[0];	var style;	var options = app.findChangeGrepOptions.properties;	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS hapu lc]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"hapu "});		app.changeGrepPreferences.properties = ({changeTo:"hapū "});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS Hapu]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"Hapu "});		app.changeGrepPreferences.properties = ({changeTo:"Hapū "});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS kokiri lc]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"kokiri "});		app.changeGrepPreferences.properties = ({changeTo:"kōkiri "});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS Kokiri]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"Kokiri "});		app.changeGrepPreferences.properties = ({changeTo:"Kōkiri "});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS maori]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"(?i)maori"});		app.changeGrepPreferences.properties = ({changeTo:"Māori"});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS nga lc]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"nga "});		app.changeGrepPreferences.properties = ({changeTo:"ngā "});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS Nga Tangata Tiaki]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"(?i)Nga Tangata Tiaki"});		app.changeGrepPreferences.properties = ({changeTo:"Ngā Tāngata Tiaki"});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS Nga]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"Nga "});		app.changeGrepPreferences.properties = ({changeTo:"Ngā "});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS whanau lc]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"whanau"});		app.changeGrepPreferences.properties = ({changeTo:"whānau"});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;	// Query [[MACRONS Whanau]] -- If you delete this comment you break the update function	try {		app.findChangeGrepOptions.properties = ({includeFootnotes:true, kanaSensitive:true, widthSensitive:true, searchBackwards:true});		app.findGrepPreferences.properties = ({findWhat:"Whanau"});		app.changeGrepPreferences.properties = ({changeTo:"Whānau"});		changeObject.changeGrep();	} catch (e) {alert(e + ' at line ' + e.line)}	app.findChangeGrepOptions.properties = options;	app.findGrepPreferences = NothingEnum.NOTHING;	app.changeGrepPreferences = NothingEnum.NOTHING;};function getStyleByString(docOrGroup, string, property) {	if (string == '[No character style]') return docOrGroup[property][0];	if (string == '[No paragraph style]') return docOrGroup[property][0];	if (string == 'NormalParagraphStyle') return docOrGroup[property][1];	stringResult = string.match (/^(.*?[^\\]):(.*)$/);	var styleName = (stringResult) ? stringResult[1] : string;	styleName = styleName.replace (/\\:/g, ':');	remainingString = (stringResult) ? stringResult[2] : '';	var newProperty = (stringResult) ? property.replace(/s$/, '') + 'Groups' : property;	var styleOrGroup = docOrGroup[newProperty].itemByName(styleName);	if (remainingString.length > 0 && styleOrGroup.isValid) styleOrGroup = getStyleByString (styleOrGroup, remainingString, property);	return styleOrGroup;};