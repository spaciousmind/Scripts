function checkWhichTable() {    //ensure user made a selection     if (app.selection.length != 1) return null;    var currentTable = app.selection[0];    if (currentTable.hasOwnProperty("baseline")) currentTable = app.selection[0].parent;    while (currentTable instanceof Cell || currentTable instanceof Row || currentTable instanceof Column) currentTable = currentTable.parent;    if (!(currentTable instanceof Table)) return null;    return currentTable;}app.doScript(checkUserSelection, ScriptLanguage.JAVASCRIPT, undefined, UndoModes.ENTIRE_SCRIPT, "Process Table");function checkUserSelection() {    var a_table = checkWhichTable();    if (a_table == null) {        if (confirm("No table selected. Do you want to process *all* tables?") == false)            return;        allTables = app.activeDocument.stories.everyItem().tables.everyItem().getElements();        for (var a = 0; a < allTables.length; a++) processTable(allTables[a]);    } else processTable(a_table);}function processTable(myTable) { //USE THIS TO FIX CODE AND COUNT ROWS//myRows = myTable.bodyRowCount;//alert (myRows)//myTable.columns[0].leftEdgeStrokeColor = "Paper";myTable.columns[0].leftEdgeStrokeWeight = 0;myTable.columns[3].rightEdgeStrokeWeight = 0;var newRow = myTable.rows.add(LocationOptions.AT_END);newRow.cells[0].topEdgeStrokeWeight = 0;newRow.cells[0].bottomEdgeStrokeWeight = 0;newRow.cells[0].leftEdgeStrokeWeight = 0;newRow.cells[0].rightEdgeStrokeWeight = 0;newRow.cells[1].topEdgeStrokeWeight = 0;newRow.cells[1].bottomEdgeStrokeWeight = 0;newRow.cells[1].leftEdgeStrokeWeight = 0;newRow.cells[1].rightEdgeStrokeWeight = 0;newRow.cells[2].topEdgeStrokeWeight = 0;newRow.cells[2].bottomEdgeStrokeWeight = 0;newRow.cells[2].leftEdgeStrokeWeight = 0;newRow.cells[2].rightEdgeStrokeWeight = 0;newRow.cells[3].topEdgeStrokeWeight = 0;newRow.cells[3].bottomEdgeStrokeWeight = 0;newRow.cells[2].leftEdgeStrokeWeight = 0;newRow.cells[2].rightEdgeStrokeWeight = 0;newRow.cells[0].merge (newRow.cells[-1]); newRow.cells[0].remove();        //myTable.cells.everyItem().properties = {w//topInset:"1mm", bottomInset:"1.5mm",//leftEdgeStrokeColor:"Paper"w  } 